import binascii

from Crypto.Util.number import getStrongPrime, bytes_to_long, inverse, long_to_bytes, GCD
import random

# DHKE
# alalicon's troplet
p = 12978774955466993847992075816707503599588973321827246379317329498102188928327007132484265762740340810329024318354336156429661149411159113322903847644385487
g = 2
A = 7151372025141592399241447220524047332156045241893513351695539236316191920401733025276121199518724902425062723311189098260177354547252176244191245788728748

# mine
b = random.randint(2, p)
while GCD(b, p-1) != 1:
    b = random.randint(2, p)

B = pow(g, b, p)
print("My B:", B)

shared = pow(A, b, p)
print("Generated Key: ", shared)
